# backend/Dockerfile
FROM alpine:3.21 AS build

RUN apk add --no-cache ca-certificates
WORKDIR /app


COPY vmwiz-backend/migrations /app/migrations
COPY vmwiz-backend/proxmox /app/proxmox/
COPY vmwiz-backend/survey /app/survey/

ARG TARGETPLATFORM
COPY $TARGETPLATFORM/vmwiz-backend /app/vmwiz-backend

FROM alpine:3.21 

COPY --from=build /app /app

ENV ENV="production"
ENTRYPOINT ["/app/vmwiz-backend", "server"]
